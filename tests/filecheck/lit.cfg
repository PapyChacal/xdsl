import lit.formats
import os

config.name = "xDSL"
config.test_format = lit.formats.ShTest()
config.suffixes = ['.test', '.xdsl', '.mlir', '.py']

config.test_source_root = os.path.dirname(__file__)
config.test_exec_root = os.path.dirname(os.path.dirname(config.test_source_root))

xdsl_opt = config.test_exec_root + "/xdsl/tools/xdsl-opt"
coveragerc = config.test_exec_root + "/.coveragerc"
data_file = config.test_exec_root + "/.coverage"

if "COVERAGE" in lit_config.params:
    config.substitutions.append(('xdsl-opt', f"coverage run --rcfile={coveragerc} --data-file={data_file} {xdsl_opt}"))
